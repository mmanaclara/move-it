import { useContext } from "react";
import { ChallengesContext } from "../../contexts/ChallengeContext";
import { CountdownContext } from "../../contexts/countdownContext";
import { Container, ChallengeActive, ChallengeNotActive } from "./styles";

export function ChallengeBox() {
  const { activeChallenge, resetChallenge, completeChallenge } = useContext(ChallengesContext);
  const { resetCountdown } = useContext(CountdownContext);

  function handleChallengeSucceeded() {
    completeChallenge();
    resetCountdown();
  }

  function handleChallengeFailed() {
    resetChallenge();
    resetCountdown();
  }

  return (
    <Container>
      {activeChallenge ? (
        <ChallengeActive>
          <header>Ganhe {activeChallenge.amount} xp</header>

          <main>
            <img src={`icons/${activeChallenge.type}.svg`} />
            <strong>Novo desafio</strong>
            <p>{activeChallenge.description}</p>
          </main>

          <footer>
            <button
              type="button"
              className="challengeFailedButton"
              onClick={handleChallengeFailed}
            >
              Falhei
            </button>
            <button
              type="button"
              className="challengeSucceededButton"
              onClick={handleChallengeSucceeded}
            >
              Completei
            </button>
          </footer>
        </ChallengeActive>
      ) : (
        <ChallengeNotActive>
          <p>Finalize um ciclo para receber desafios</p>
          <svg width="59" height="80" viewBox="0 0 59 80" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M43.3272 33.5322V58.4572H15.1402V33.5322H3.86542L29.2337 3.04053L54.6019 33.5322H43.3272Z" fill="#04D361"/>
              <path d="M55.6392 36.3211C54.7902 36.3211 53.95 35.9714 53.3703 35.2944L29.2812 7.16071L5.195 35.2944C4.16738 36.4945 2.32878 36.6651 1.07573 35.6916C-0.177327 34.7097 -0.361767 32.9502 0.659999 31.7557L27.0122 0.975602C28.1277 -0.325201 30.4318 -0.325201 31.5472 0.975602L57.9023 31.7557C58.927 32.9502 58.7397 34.7125 57.4866 35.6916C56.945 36.1141 56.2921 36.3211 55.6392 36.3211Z" fill="#04D361"/>
              <path d="M14.6422 61.4982C13.0232 61.4982 11.7145 60.2478 11.7145 58.7008V33.524C11.7145 31.977 13.0232 30.7266 14.6422 30.7266C16.2613 30.7266 17.5699 31.977 17.5699 33.524V58.7008C17.5699 60.2478 16.2613 61.4982 14.6422 61.4982Z" fill="#04D361"/>
              <path d="M43.9192 61.4979H14.6422C13.0232 61.4979 11.7145 60.2475 11.7145 58.7005C11.7145 57.1535 13.0232 55.9031 14.6422 55.9031H43.9192C45.5382 55.9031 46.8469 57.1535 46.8469 58.7005C46.8469 60.2475 45.5382 61.4979 43.9192 61.4979Z" fill="#04D361"/>
              <path d="M43.9198 61.4982C42.3007 61.4982 40.9921 60.2478 40.9921 58.7008V33.524C40.9921 31.977 42.3007 30.7266 43.9198 30.7266C45.5388 30.7266 46.8475 31.977 46.8475 33.524V58.7008C46.8475 60.2478 45.5388 61.4982 43.9198 61.4982Z" fill="#04D361"/>
              <path d="M14.6431 36.3214H2.92941C1.31039 36.3214 0.00170898 35.071 0.00170898 33.524C0.00170898 31.977 1.31039 30.7266 2.92941 30.7266H14.6431C16.2621 30.7266 17.5708 31.977 17.5708 33.524C17.5708 35.071 16.2621 36.3214 14.6431 36.3214Z" fill="#04D361"/>
              <path d="M55.6364 36.3214H43.9198C42.3007 36.3214 40.9921 35.071 40.9921 33.524C40.9921 31.977 42.3007 30.7266 43.9198 30.7266H55.6364C57.2554 30.7266 58.5641 31.977 58.5641 33.524C58.5641 35.071 57.2554 36.3214 55.6364 36.3214Z" fill="#04D361"/>
              <path d="M34.872 39.2014H23.5973C22.0385 39.2014 20.7786 37.9222 20.7786 36.3397C20.7786 34.7572 22.0385 33.478 23.5973 33.478H34.872C36.4308 33.478 37.6907 34.7572 37.6907 36.3397C37.6907 37.9222 36.4308 39.2014 34.872 39.2014Z" fill="#4D4A4A"/>
              <path d="M29.2341 44.9222C27.6754 44.9222 26.4154 43.643 26.4154 42.0605V30.6194C26.4154 29.0369 27.6754 27.7577 29.2341 27.7577C30.7928 27.7577 32.0528 29.0369 32.0528 30.6194V42.0605C32.0528 43.643 30.7928 44.9222 29.2341 44.9222Z" fill="#4D4A4A"/>
              <rect x="11.694" y="65.1582" width="35.1773" height="5.59071" rx="2.79536" fill="#04D361"/>
              <rect x="11.694" y="74.4093" width="35.1773" height="5.59071" rx="2.79536" fill="#04D361"/>
          </svg>
          <span>Avance de n√≠vel completando os desafios.</span>
          <svg width="110" height="22" viewBox="0 0 130 22" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g clipPath="url(#clip0_200949_47)">
              <path d="M54.0829 11.0244L52.2572 19.3411H47.5014L49.327 11.0244C49.4701 10.3707 49.3871 10.2502 48.7132 10.2502H46.9963C46.3267 10.2502 46.1865 10.3707 46.0449 11.0078C46.0449 11.0078 46.0449 11.0188 46.0449 11.0244L44.2192 19.3411H39.4591L41.2861 11.0244C41.4292 10.3707 41.3462 10.2502 40.6709 10.2502H38.954C38.2787 10.2502 38.1428 10.3721 37.9997 11.0244L36.1726 19.3411H31.4167L34.2196 6.5745H38.0827L38.695 7.67139C39.0473 7.31236 39.4737 7.02914 39.9465 6.84016C40.4193 6.65117 40.9279 6.56066 41.4392 6.5745H42.425C44.285 6.5745 45.5398 7.357 45.9891 8.67964C46.8203 7.20881 48.025 6.5745 49.4801 6.5745H50.4673C53.2616 6.5745 54.6824 8.32094 54.0829 11.0244Z" fill="white"/>
              <path d="M68.5863 11.0244L67.7379 14.8912C67.1441 17.5946 64.955 19.3411 62.1579 19.3411H58.5552C55.7624 19.3411 54.3416 17.5932 54.9354 14.8898L55.7838 11.0244C56.3762 8.3209 58.5652 6.57446 61.3638 6.57446H64.9722C67.7593 6.57446 69.1815 8.3209 68.5863 11.0244ZM63.8262 11.0244C63.9692 10.3707 63.8862 10.2502 63.2124 10.2502H61.4954C60.8201 10.2502 60.6842 10.372 60.5411 11.0244L59.6912 14.8898C59.5482 15.5435 59.6326 15.664 60.3065 15.664H62.0234C62.6973 15.664 62.8346 15.5421 62.9777 14.8898L63.8262 11.0244Z" fill="white"/>
              <path d="M98.2675 10.0078C98.0934 10.7336 97.6733 11.382 97.0742 11.8498L94.6519 13.7888C94.0711 14.2615 93.3404 14.5274 92.5816 14.5422H89.2279L89.1521 14.8843C89.009 15.538 89.092 15.6585 89.7673 15.6585H97.0242L96.2172 19.3356H88.0104C85.2175 19.3356 83.7968 17.5877 84.3905 14.8843L85.239 11.0189C85.8327 8.31541 88.0218 6.56897 90.8189 6.56897H94.4302C97.2159 6.57451 98.6567 8.22954 98.2675 10.0078ZM93.2856 11.0244C93.4286 10.3707 93.3457 10.2502 92.6703 10.2502H90.9534C90.281 10.2488 90.1379 10.3721 89.9948 11.0244L89.7087 12.3554H92.5416C92.6686 12.3503 92.7904 12.3052 92.8886 12.2269C92.9867 12.1487 93.0558 12.0416 93.0853 11.9219L93.2856 11.0244Z" fill="white"/>
              <path d="M103.614 17.1736C103.351 18.3716 102.374 19.3424 100.896 19.3424C99.4176 19.3424 98.8682 18.373 99.1315 17.1736C99.3947 15.9742 100.372 15.0061 101.85 15.0061C103.328 15.0061 103.873 15.9742 103.614 17.1736Z" fill="#04D361"/>
              <path d="M113.818 6.57445L113.011 10.2488L111.008 19.3397H106.254L108.257 10.2488H105.883L106.691 6.57307L113.818 6.57445ZM110.287 4.19093C109.463 3.30455 109.715 1.78386 110.846 0.796381C111.978 -0.191099 113.565 -0.271427 114.393 0.616336C115.222 1.5041 114.965 3.02479 113.834 4.01227C112.702 4.99975 111.112 5.08008 110.287 4.19093Z" fill="white"/>
              <path d="M121.45 8.41236L120.028 14.8898C119.885 15.5435 119.968 15.664 120.642 15.664H123.599L122.792 19.3411H118.887C116.095 19.3411 114.672 17.5933 115.266 14.8898L116.688 8.41236H114.89L115.697 4.73528H117.5L118.161 1.72437H122.921L122.26 4.73528H126.003L125.191 8.41236H121.45Z" fill="white"/>
              <path d="M12.8565 1.87256H18.8915L13.871 25.0001H7.836L12.8565 1.87256Z" fill="#5965E0"/>
              <path d="M21.7117 1.87256H27.7466L23.8349 19.9934H17.7985L21.7117 1.87256Z" fill="#5965E0"/>
              <path d="M3.91295 1.87256H9.9479L6.0362 19.9934H-0.000183105L3.91295 1.87256Z" fill="#5965E0"/>
              <path d="M86.1975 6.57446L77.3797 19.3411H72.5151L69.2988 6.57446H74.5082L75.9089 14.9577L80.9881 6.58139L86.1975 6.57446Z" fill="white"/>
              </g>
              <defs>
              <clipPath id="clip0_200949_47">
              <rect width="126" height="25" fill="white"/>
              </clipPath>
              </defs>
          </svg>
        </ChallengeNotActive>
      )}

    </Container>
  )
}